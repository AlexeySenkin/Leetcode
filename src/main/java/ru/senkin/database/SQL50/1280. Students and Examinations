/* Write your T-SQL query statement below */
with stud_sub AS (
    select distinct s.student_id, b.subject_name
    from Students s, Subjects b
)
select s.student_id, s.student_name, sb.subject_name,
    SUM(CASE WHEN e.student_id IS NOT NULL THEN 1 ELSE 0 END)  AS attended_exams
from stud_sub sb
    INNER JOIN Students s ON s.student_id = sb.student_id
    left join Examinations e ON e.student_id = sb.student_id AND e.subject_name = sb.subject_name

group by s.student_id, s.student_name, sb.subject_name
order by s.student_id, s.student_name