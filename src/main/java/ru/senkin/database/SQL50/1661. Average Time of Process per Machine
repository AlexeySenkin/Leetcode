/* Write your T-SQL query statement below */
select a1.machine_id, ROUND(SUM(a2.timestamp - a1.timestamp) / COUNT(*), 3) AS processing_time
from Activity a1
    inner join Activity a2 ON a2.machine_id = a1.machine_id AND a2.process_id = a1.process_id and a2.activity_type = 'end'
where a1.activity_type = 'start'
group by a1.machine_id