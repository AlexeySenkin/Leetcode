/* Write your T-SQL query statement below */
select
    CONVERT(char(7),trans_date) AS [month],
    t.country, COUNT(*) AS [trans_count],
    SUM(CASE WHEN t.state = 'approved' THEN 1 ELSE 0 END) AS [approved_count],
    SUM(amount) AS [trans_total_amount],
    SUM(CASE WHEN t.state = 'approved' THEN t.amount ELSE 0 END) AS [approved_total_amount]
from Transactions t
GROUP BY CONVERT(char(7),trans_date), t.country